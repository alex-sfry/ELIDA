(()=>{"use strict";const t=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&function(t){""!==t&&$(t).addClass("opacity-25")}(e);try{const e=await fetch(t,{method:"GET",headers:{contentType:"application/json"}});if(e.ok)return await e.json();console.log("fetch error")}catch(t){console.log(t.message)}finally{e&&function(t){$(t).removeClass("opacity-25")}(e)}};function e(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.fetchData=e,this.maxPageBtnQty=t,this.paginationHTML=a,this.data=null}function a(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.cnt=t,this.pagination=a,this.fetchData=e,this.data=null}e.prototype.getCurrentDataPage=function(){return $("li.active > a").attr("data-page")},e.prototype.renderData=function(t){},e.prototype.renderNewPageBtns=function(t,e,a,n,i,s,r){const o=$("li > .page-link"),c=parseInt(o.eq(2).attr("data-page"))+1,l=parseInt(o.eq(o.length-3).attr("data-page"))+1,d=1===e?"page-link disabled":"page-link",g=e===a?"page-link disabled":"page-link",p=r<=a?r:a;let h='<li class="page-item first"><a class="'.concat(d,'" href="').concat(t.first,'" data-page="0">first</a></li>');h+='<li class="page-item prev-page">\n                <a class="'.concat(d,'" href="').concat(t.prev,'" data-page="').concat(e-1,'">\n                    <span aria-hidden="true">«</span>\n                </a>\n            </li>');for(let i=0;i<p;i++){const s=t.first.substring(0,t.first.length-1);let r;r=e>n?e>=a-1?a-(p-1)+i:l-e<2?e-(p-3)+i:c+i:e<=2?1+i:e-c<2?e-2+i:c+i;h+='<li class="'.concat(r===e?"page-item active":"page-item",'">\n                        <a class="page-link" href="').concat(s).concat(r,'" data-page="').concat(r-1,'">').concat(r,"</a>\n                    </li>")}h+='<li class="page-item next-page">\n                    <a class="'.concat(g,'" href="').concat(t.next,'" data-page="').concat(e-1,'">\n                        <span aria-hidden="true">»</span>\n                    </a>\n                </li>'),h+='<li class="page-item last">\n                    <a class="'.concat(g,'" href="').concat(t.last,'" data-page="').concat(a-1,'">last</a>\n                </li>'),$(".pagination").html(h),$(".page-counter").text("".concat(this.getCurrentDataPage()*s+1," \n       - ").concat(e*s<i?e*s:i," / ").concat(i)),this.setEventListeners()},e.prototype.handleClick=async function(t){if(t.preventDefault(),$(t.currentTarget).parent().is(".active"))return;const e=await this.fetchData($(t.currentTarget).attr("href"));this.data=e,this.renderNewPageBtns(e.links,e.page+1,e.lastPage,this.getCurrentDataPage(),e.totalCount,e.limit,this.maxPageBtnQty),this.renderData(e)},e.prototype.resetPagination=function(t,e){$(".pagination").html(this.paginationHTML),$(".page-counter").text("".concat(0*t+1," - ").concat(1*t," / ").concat(e)),this.setEventListeners()},e.prototype.setEventListeners=function(){$(".page-item > .page-link").on("click",(t=>this.handleClick(t)))},a.prototype.renderData=function(t){},a.prototype.handleClick=async function(t){t.preventDefault();const e=await this.fetchData($(t.currentTarget).attr("href"));this.data=e,this.pagination&&this.pagination.resetPagination.apply(this.pagination,[e.limit,e.totalCount]),$("a.sort").removeClass(["asc","desc","sorted"]),4===Object.values(e.attributeOrders)[0]?$(t.currentTarget).addClass(["sorted","asc"]):$(t.currentTarget).addClass(["sorted","desc"]),$(t.currentTarget).attr("href",e.sortUrl),this.renderData(e)},a.prototype.setEventListeners=function(){$(this.cnt+" .sort").on("click",(t=>this.handleClick(t)))};const n=(t,e,a,n)=>{const i=document.querySelector("#tr-form");i.addEventListener("submit",(e=>(e=>{const a=document.querySelector("label[for='cargo']"),n=document.querySelector("#cargo"),s=document.querySelector("label[for='profit']"),r=document.querySelector("#profit");i.checkValidity()||e.preventDefault(),t(n,a),t(r,s)})(e)))},i=(t,e)=>{t.checkValidity()?r(t,e):s(t,e)},s=(t,e)=>{e.classList.add("text-danger","is-invalid"),t.classList.remove("border-dark"),t.classList.add("is-invalid","border-2","border-danger")},r=(t,e)=>{e.classList.remove("text-danger","is-invalid"),t.classList.add("border-dark"),t.classList.remove("is-invalid","border-2","border-danger")},o=()=>{$(".menu__link").each((function(){$(this).attr("href")===window.location.pathname||window.location.pathname.includes($(this).attr("href"))?$(this).addClass("active"):$(this).removeClass("active")}))},c=(t,e)=>{t.after("<div class='c-loading my-0 mx-auto text-light bg-light-orange rounded-2 p-2 fw-bold'>Loading . . .</div>"),e.length&&(e.addClass("d-none"),$(".c-pagination-cnt").addClass("d-none"),$(".c-result-legend").addClass("d-none"))},l=t=>{if(t.length){const t=$(".c-loading");t.length&&t.remove()}};document.addEventListener("DOMContentLoaded",(()=>{o(),$("#c-form").length&&((t,n,i)=>{const s=$("#c-form"),r=$(".c-table"),o=$(".pagination");n(r),s.on("submit",(e=>{s[0].checkValidity()?t(s,r):e.preventDefault()}));const c={set(t,e,a){if("data"===e)return console.log(a),a}},l=o.length?new Proxy(new e(7,i,o.html()),c):null,d=o.length?new Proxy(new a(".c-table",i,l),c):null;l.setEventListeners(),d.setEventListeners()})(c,l,t),$("#tr-form").length&&n(i)}))})();
//# sourceMappingURL=main.min.js.map